+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| EXPLAIN                                                                                                                                                                                                                       |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -> Group aggregate: sum(sales.amount)  (cost=33177 rows=955) (actual time=4.32..45.4 rows=1000 loops=1)
    -> Index scan on sales using idx_customer  (cost=10091 rows=100190) (actual time=4.31..42.9 rows=100000 loops=1)
 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| EXPLAIN                                                                                                                                                                                                                                                                                                                                                                   |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -> Group aggregate: sum(sales.amount)  (cost=21634 rows=955) (actual time=2.68..47.3 rows=1000 loops=1)
    -> Filter: (sales.created_at > TIMESTAMP'2025-01-01 00:00:00')  (cost=10091 rows=50095) (actual time=2.67..45.3 rows=83832 loops=1)
        -> Index scan on sales using idx_customer  (cost=10091 rows=100190) (actual time=2.67..42.4 rows=100000 loops=1)
 |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| EXPLAIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| -> Limit: 50 row(s)  (cost=6868 rows=50) (actual time=4.99..4.99 rows=50 loops=1)
    -> Sort: sales.amount DESC, limit input to 50 row(s) per chunk  (cost=6868 rows=15262) (actual time=4.99..4.99 rows=50 loops=1)
        -> Index range scan on sales using idx_created over ('2025-05-01 00:00:00' <= created_at <= '2025-06-01 00:00:00'), with index condition: (sales.created_at between '2025-05-01' and '2025-06-01')  (cost=6868 rows=15262) (actual time=0.738..4.46 rows=8550 loops=1)
 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
